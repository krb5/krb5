2005-11-29  Ken Raeburn  <raeburn@mit.edu>

	* policy_db.h: Include db.h after gssrpc/types.h, to fix
	compilation on Tru64.

2005-11-17  Ken Raeburn  <raeburn@mit.edu>

	* policy_db.h: Include errno.h and krb5.h instead of k5-int.h.

2005-10-27  Ken Raeburn  <raeburn@mit.edu>

	* configure.in: Set build_dynobj=yes.

	* Makefile.in (DYNOBJ_LOADER_PROG, DYNOBJ_EXPLIBS_WITH_LOADER,
	DYNOBJ_EXPDEPS_WITH_LOADER): New variables.

2005-10-13  Ken Raeburn  <raeburn@mit.edu>

	* Makefile.in (SHLIB_EXPLIBS): Revert 10-04 change; add support
	library.

2005-10-06  Ken Raeburn  <raeburn@mit.edu>

	* Makefile.in (DBSHOBJLISTS): New variable.
	($(DBOBJLISTS-k5), $(DBSHOBJLISTS)): Depend on recursion step.

2005-10-04  Ken Raeburn  <raeburn@mit.edu>

	* libdb2: Directory moved from util/db2.
	* configure.in: Configure it, unless a system version is to be
	used.
	* Makefile.in (DBDIR): Updated.
	($(DB_DEPS)): Depend on all-recurse.
	(DB_VERSION, DB_DEPS, DB_DEPS-sys, DB_DEPS-k5, DB_DEPS-redirect,
	DB_LIB, KDB5_DB_LIB, DB_DEPLIB, DB_DEPLIB-k5, DB_DEPLIB-sys):
	Variable definitions moved here from config/pre.in.
	(.depend-verify-db, depend-verify-db-k5, depend-verify-db-sys):
	New targets, moved from config/post.in.
	(.d): Depend on .depend-verify-db.

	* Makefile.in (SHLIB_EXPLIBS): Only use gssrpc and KDB5_DB_LIB.
	* configure.in: Set enable_shared=yes.

	* kdb_xdr.c (krb5_dbe_create_key_data, krb5_dbe_update_tl_data,
	krb5_dbe_lookup_tl_data, krb5_dbe_update_last_pwd_change,
	krb5_dbe_lookup_last_pwd_change, krb5_dbe_update_mod_princ_data,
	krb5_dbe_lookup_mod_princ_data, krb5_dbe_search_enctype,
	krb5_dbe_find_enctype): Unused functions deleted.
	(safe_realloc): Unused macro deleted.

2005-09-22  Ken Raeburn  <raeburn@mit.edu>

	* Directory moved from lib/kdb/kdb_db2 to modules/kdb/db2.
	* Makefile.in (myfulldir, LOCALINCLUDES, RELDIR): Updated.
	* db2_exp.c, kdb_db2.c: Include kdb5.h instead of ../kdb5.h.

2005-08-20  Ken Raeburn  <raeburn@mit.edu>

	* configure.in: Use K5_AC_INIT instead of AC_INIT.

2005-08-19  Ken Raeburn  <raeburn@mit.edu>

	* kdb_db2.c (MAX_LOCK_TRIES): New macro.
	(krb5_db2_db_lock): Always make non-blocking attempts to acquire
	the lock.  Retry up to MAX_LOCK_TRIES times on failure.

2005-07-06  Ken Raeburn  <raeburn@mit.edu>

	* Makefile.in (LIBBASE): Change to db2.
	(LIBMAJOR): Change to 0.
	(all): Deleted explicit dependency.
	(all-unix): Added here, without "lib" prefix.
	(clean-unix): Drop clean-liblinks.
	* db2_exp.c: (krb5_db_vftabl_db2): Renamed from ..._kdb_db2.
	* db2.exports: Rename from libkdb_db2.exports, update for symbol
	name change.

2005-07-01  Ken Raeburn  <raeburn@mit.edu>

	* kdb_db2.c: Reindent.  Use ISO C function decl style.  Delete
	functions inside "#if 0".

2005-06-29  Ken Raeburn  <raeburn@mit.edu>

	* Makefile.in: Use libnover_frag.
	(LIB): Variable deleted, uses replaced with LIBBASE.
	(SHLIB_EXPDEPS, SHLIB_EXPLIBS): Add gssrpc library and
	depedencies.
	(all-unix): Don't depend on all-liblinks.
	(lib$(LIBBASE)$(SO_EXT)): Rule deleted.
	(t_kdb, check, clean): Delete t_kdb references.

2005-06-27  Ken Raeburn  <raeburn@mit.edu>

	* kdb_db2.c: Don't use C++-style comments.
	(krb5_db2_db_get_principal): Don't use variables named "try".

2005-06-20  Ken Raeburn  <raeburn@mit.edu>

	Novell merge.
	* Makefile.in:
	* adb_openclose.c: Moved from lib/kadm5/srv.  Include k5-int.h,
	policy_db.h, db.h; don't include adb.h.
	(osa_adb_create_db, osa_adb_destroy_db, osa_adb_rename_db,
	osa_adb_init_db, osa_adb_fini_db, osa_adb_get_lock,
	osa_adb_release_lock, osa_adb_open_and_lock,
	osa_adb_close_and_unlock): Return krb5_error_code instead of
	osa_adb_ret_t.
	(osa_adb_rename_db, osa_adb_fini_db, osa_adb_get_lock,
	osa_adb_release_lock): Change OSA_ADB_* lock flags to
	KRB5_DB_LOCKMODE_* flags.
	(osa_adb_get_lock): Initialize return variable.
	* adb_policy.c: Moved from lib/kadm5/srv.  Include policy_db.h;
	don't include adb.h.
	(osa_adb_create_policy_db, osa_adb_rename_policy_db,
	osa_adb_destroy_policy_db, osa_adb_open_policy,
	osa_adb_close_policy): Functions deleted.
	(osa_adb_create_policy, osa_adb_destroy_policy,
	osa_adb_get_policy, osa_adb_put_policy, osa_adb_iter_policy):
	Return krb5_error_code instead of osa_adb_ret_t.  Change OSA_ADB_*
	lock flags to KRB5_DB_LOCKMODE_* flags.
	(osa_adb_get_policy): Change policy name argument from
	kadm5_policy_t to char*.  Add int* argument for returning count of
	entries.  If no entries found, return success and zero count.
	(osa_free_policy_ent): Moved here from old
	lib/kadm5/srv/adb_free.c.
	* configure.in:
	* db2_exp.c:
	* kdb_compat.h:
	* kdb_db2.c:
	* kdb_db2.h:
	* kdb_xdr.c:
	* kdb_xdr.h:
	* libkdb_db2.exports: New file.  Export only the virtual function
	table.
	* pol_xdr.c:
	* policy_db.h:

