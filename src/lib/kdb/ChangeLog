
Fri Aug 18 17:27:20 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_dbm.c - Bump timestamp to the future if we can't discriminate
		between updates within a second.  Fix database rename.  Reopen
		database after put or delete.
	* t_kdb.c - Add test code to fork off a few processes to beat on the
		database.


Thu Aug 17 13:46:29 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_dbm.c - Remove argument from dbm_db_end_update().  It was never
		used.  Remove gen_dbsuffix() logic from dbm_db_end_update() and
		dbm_db_get_age().  This logic was incorrect (end_update) or
		unused (get_age).  Reorg db_init() to reflect change in
		dbm_db_get_age().


Wed Aug 16 03:10:57 1995  Chris Provenzano  <proven@mit.edu>

	* decrypt_key.c, encrypt_key.c
		Only save the salt data if salt type != 0.
	* kdb_dbm.c :
		Rewritten to NOT open/close the db for every transaction.

Tue Aug 15 14:25:42 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_xdr.c - Add krb5_dbe_find_keytype() and clean up gcc -Wall
		complaints.


Wed Aug 9 17:17:36 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_cpw.c - Add check for uniqueness of key or key/salt combo.  Don't
		generate a new key_data entry if one already exists.  Also,
		fill in the key_data list at the end so as not to overwrite
		already present data.
		- Free krbtgt_keyblock contents in add_key_rnd().
		- Put a "break" at the end of the KRB5_KDB_SALTTYPE_ONLYREALM
		  in add_key_pwd().  Also pass in key_salt to encrypt_key_data
		  always.
	* kdb_xdr.c - initialize retval to 0 in decode_mod_princ data.  This is
		questionable whether we should return an error if there's no
		mod_princ data.  Also, free the allocated mod_princ only if
		we allocated it and there's a failure.


Wed Aug 9 09:47:08 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_cpw.c(add_key_rnd) - Terminate the variable length argument list
		to krb5_build_principal_ext() with a zero.

Tue Aug  8 21:32:30 1995  Tom Yu  <tlyu@dragons-lair.MIT.EDU>

	* kdb_cpw.c (add_key_rnd): remove bletcherous aggregate
		initializer stuff and use build_principal_ext like we
		should have in the first place to build the tgt principal.

Tue Aug 8 17:35:58 EDT 1995	Paul Park	(pjpark@mit.edu)
	* encrypt_key.c - When allocating the actual key_data_contents use the
		correct length (e.g. containing the two length bytes).
	* kdb_xdr.c - Clean the each key_data structure so that unfilled
		data becomes zero.


Mon Aug 7 17:40:10 EDT 1995	Paul Park	(pjpark@mit.edu)
	* encrypt_key.c - Handle keysalt specification with null data length.
	* decrypt_key.c - Handle salttypes with zero salt length.  Also, copy
		out stored salt.


Mon Aug 7 14:15:59 EDT 1995	Paul Park	(pjpark@mit.edu)
	* decrypt_key.c - Deserialize key length into a 16 bit integer, then
		jam it into the keyblock.


Mon Aug 7 13:05:53 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_cpw.c(add_key_rnd) - Manually initialize krbtgt_princ.data to
		point to krbtgt_princ_entries since some compilers do not
		support dynamic initializers.


Mon Aug 07 11:27:37 1995  Chris Provenzano (proven@mit.edu)

	* kdb_cpw.c: New routines for changing passwords of db_entried.

Fri Aug  4 23:26:22 1995  Tom Yu  <tlyu@dragons-lair.MIT.EDU>

	* setup_mkey.c (krb5_db_setup_mkey_name), 
	* fetch_mkey.c (krb5_db_fetch_mkey), 
	* verify_mky.c (krb5_db_verify_master_key),
	* decrypt_key.c (krb5_dbekd_decrypt_key_data),
	* encrypt_key.c (krb5_dbekd_encrypt_key_data),
	* kdb_xdr.c, kdb_dbm.c,
		Add parens to shut up gcc -Wall

Fri Aug 4 16:22:46 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_xdr,{de,en}crypt_key.c - Use encode/decode macros to [de]serialize
		data going in and out of the database.


Thu Aug 3 11:52:40 EDT 1995	Paul Park	(pjpark@mit.edu)
	* encrypt_key.c - Actually copy in the salt data which we allocated
		space for in krb5_dbekd_encrypt_key_data().
	* kdb_xdr.c - Correctly generate the tl_data list in krb5_decode_princ_
		contents().  Also allow for key_data_ver to be KRB5_KDB_V1_DATA_
		ARRAY.


Mon Jul 31 15:55:46 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_xdr.c - Correctly parenthesize realloc() expression in create_key
		_data().


Thu Jul 27 15:28:41 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdbint.h - Obsolete.

Thu Jul 27 02:59:05 1995  Chris Provenzano (proven@mit.edu)
        * decrypt_key.c, encrypt_key.c, kdb_dbm.c, kdb_xdr.c:
		Rewritten for new kdb format.
	* kdb_cpw.c : New password changing routines for new kdb format.
	* verify_mky.c, t_kdb.c : Use new kdb format.

Tue Jul 25 14:06:50 1995  Tom Yu  <tlyu@lothlorien.MIT.EDU>

	* kdb_dbm.c, t_kdb.c: Add prototype for dbm_error and dbm_clearerr
		in case they're not prototyped in the header files.

	* configure.in: Add test for missing prototypes for dbm_error and
		dbm_clearerr.

Thu Jul 20 23:59:18 1995  Mark Eichin  <eichin@cygnus.com>

	* kdb_dbm.c (krb5_dbm_db_create): move dirname, pagname
	declarations to the top of function, so it compiles...

Mon Jul 17 15:17:53 EDT 1995	Paul Park	(pjpark@mit.edu)
	* fetch_mkey.c - Remove inclusion of kdbint.h and add handling of
		stash file argument.
	* store_mkey.c - Remove inclusion of kdbint.h.  The default name of
		the stash file is in osconf.h now.

Sat Jul  8 22:37:14 1995  Theodore Y. Ts'o  (tytso@dcl)

	* kdb_dbm.c (kdb5_kdbm_db_create): Make sure the dbm context is
		initialized before we start.

Fri Jul 7 16:29:22 EDT 1995	Paul Park	(pjpark@mit.edu)
	* Makefile.in - Remove LDFLAGS, find com_err in TOPLIBD.


Fri Jun 30 14:39:45 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_dbm.c - Add function dispatch table to context and use it to
		perform database accesses.  Add kdb5_db_set_dbops() to set
		a context's function dispatch table.
	* Makefile.in - Remove Berkeley database object modules from this
		library.  They're now in libkrb5 since we use them in
		other places.
	* t_kdb.c - Add ability to test both DBM and Berkeley database
		format.

Thu Jun 29 06:54:00 1995  Mark Eichin  <eichin@cygnus.com>

	* configure.in (--with-dbm): new option, allows easy building of
	normal dbm support for compatibility.
	* Makefile.in (DBFLAGS): variable to hold substitution of flags to
	enable Berkeley db support.

Thu Jun 22 11:59:28 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_dbm.c - Replace static kdb context with context which is attached
		to krb5 context.  This allows for multiple open databases
		within the same process.


Thu Jun 15 18:04:58 EDT 1995	Paul Park	(pjpark@mit.edu)
	* Makefile.in - Remove explicit copying of archive library to library
		directory.  Add dependency on all-$(WHAT)
	* configure.in - Create symlink for archive when we build it.

Wed Jun 14 12:37:51 1995  Sam Hartman  <hartmans@tardis.MIT.EDU>

	* configure.in: Check for umask being defined.

	* store_mkey.c (krb5_db_store_mkey): Use HAVE_UMASK instead of
	unix as a preprocessor define for setting the umask.  AIX doesn't
	define unix.

	* t_kdb.c (main): Declare option as int, not char.  When char is
	unsigned, the comparison to EOF fails and it loops forever.


Sun Jun 11 09:26:48 1995  Ezra Peisach  <epeisach@kangaroo.mit.edu>

	* Makefile.in (clean): Remove t_kdb and t_kdb.o

Fri Jun  9 19:26:49 1995    <tytso@rsx-11.mit.edu>

	* configure.in: Remove standardized set of autoconf macros, which
		are now handled by CONFIG_RULES.

Tue May 30 12:31:26 EDT 1995	Paul Park	(pjpark@mit.edu)
	* Makefile.in: ranlib the library again after doing $(LIBUPDATE).
		Some archivers don't do this.

Fri May 26 17:52:03 EDT 1995	Paul Park	(pjpark@mit.edu)
	* kdb_dbm.c - Change usage of dbm package or Berkeley db package
		based on setting of BERK_DB_DBM.  Also, conditionalize
		implicit knowledge of dbm/Berkeley db filename extensions.
	* Makefile.in - Set BERK_DB_DBM when compiling.  Update from Berkeley
		db build directory.
	* configure.in - Check for random number generators.
	* t_kdb.c - New tester for kdb code.

Fri Mar 24 21:59:34 1995  Theodore Y. Ts'o  <tytso@dcl>

	* store_mkey.c (krb5_db_store_mkey): 
	* fetch_mkey.c (krb5_db_fetch_mkey): Hardcode the size of the
		keytype field in the file format, to be compatible with
		what was used in the Beta 4 release (before we changed the
		size of a krb5_keytype type).

Fri Mar 24 15:13:53 1995    <tytso@rsx-11.mit.edu>

	* kdb_dbm.c: Don't cast dbm_close() to void, because dbm_close is
		already void.

Tue Feb 28 00:30:10 1995  John Gilmore  (gnu at toad.com)

	* decrypt_key.c, encrypt_key.c, fetch_mkey.c, kdb_dbm.c,
	setup_mkey.c, store-mkey.c, verify_mky.c:  Avoid <krb5/...> includes.

Fri Jan 13 15:23:47 1995  Chris Provenzano (proven@mit.edu)

    * Added krb5_context to all krb5_routines

Thu Nov 17 19:22:16 1994  Mark Eichin  (eichin@cygnus.com)

	* kdb_dbm.c (krb5_dbm_db_unlock): Use krb5_lock_file.
	(krb5_dbm_db_lock): Same. (Changes from jtkohl@mit.edu.)

Thu Nov 10 17:20:42 1994  Theodore Y. Ts'o  (tytso@dcl)

	* decrypt_key.c (krb5_kdb_decrypt_key): Set the keyblock's magic
		number and ecryption type information appropriately.

Tue Nov  8 18:03:23 1994  Theodore Y. Ts'o  (tytso@dcl)

	* fetch_mkey.c (krb5_db_fetch_mkey): Set the keyblock's magic
		number and encryption type information appropriately.

Sat Oct 22 10:13:25 1994    (tytso@rsx-11)

	* kdb_dbm.c: Don't need to define POSIX_FILE_LOCKS; just include
		config.h instead.

Wed Oct 19 12:15:36 1994  Theodore Y. Ts'o  (tytso@dcl)

	* Makefile.in: make install obey $(DESTDIR) completely

Fri Oct 14 00:57:33 1994  Theodore Y. Ts'o  (tytso@dcl)

	* configure.in: Add test for unistd.h

	* lock_file.c: Use POSIX_FILE_LOCKS if _POSIX_VERSION is defined
		in unistd.h

Tue Oct  4 15:08:03 1994  Theodore Y. Ts'o  (tytso@dcl)

	* kdb_dbm.c (decode_princ_contents): Add backwards compatibility
		for version numbers 1.0 and 2.0.  

Mon Oct  3 22:47:49 1994  Theodore Y. Ts'o  (tytso@dcl)

	* kdb_dbm.c (decode_princ_contents): Force an incompatible version
		number change to the database --- we are now at database
		entry version 2.0.  Unfortunately, the way we encode the
		database is completely broken, and any structure changes
		change the encoding format.  We will need to redo this
		completely at some point, so we don't have to make people
		go through this again.

	* Makefile.in: make install obey $(DESTDIR)

Thu Aug  4 03:41:44 1994  Tom Yu  (tlyu@dragons-lair)

	* configure.in: look for install program

	* Makefile.in: make install fixes

Fri Jul 15 14:54:10 1994  Theodore Y. Ts'o  (tytso at tsx-11)

	* kdb_dbm.c (krb5_dbm_db_end_update): Change use of utimes() to
	the POSIX utime() function.


