CFLAGS = $(CCOPTS) $(DEFS) -I. -I$(srcdir) -I../generic -I$(srcdir)/../generic

##DOS##BUILDTOP = ..\..\..
##DOS##PREFIXDIR=krb5
##DOS##OBJFILE = ..\krb5.lst
##WIN16##LIBNAME=..\gssapi.lib

ETSRCS= gssapi_err_krb5.c
ETOBJS= gssapi_err_krb5.$(OBJEXT)
ETHDRS= gssapi_err_krb5.h

gssapi_err_krb5.$(OBJEXT): gssapi_err_krb5.c
gssapi_err_krb5.h: gssapi_err_krb5.et
gssapi_err_krb5.c: gssapi_err_krb5.et

SRCS = \
	$(srcdir)/accept_sec_context.c \
	$(srcdir)/acquire_cred.c \
	$(srcdir)/canon_name.c \
	$(srcdir)/compare_name.c \
	$(srcdir)/context_time.c \
	$(srcdir)/delete_sec_context.c \
	$(srcdir)/disp_name.c \
	$(srcdir)/disp_status.c \
	$(srcdir)/duplicate_name.c \
	$(srcdir)/export_name.c \
	$(srcdir)/export_sec_context.c \
	$(srcdir)/get_tkt_flags.c \
	$(srcdir)/gssapi_krb5.c \
	$(srcdir)/import_name.c \
	$(srcdir)/import_sec_context.c \
	$(srcdir)/indicate_mechs.c \
	$(srcdir)/init_sec_context.c \
	$(srcdir)/inq_context.c \
	$(srcdir)/inq_cred.c \
	$(srcdir)/inq_names.c \
	$(srcdir)/k5seal.c \
	$(srcdir)/k5unseal.c \
	$(srcdir)/krb5_gss_glue.c \
	$(srcdir)/process_context_token.c \
	$(srcdir)/rel_cred.c \
	$(srcdir)/rel_oid.c \
	$(srcdir)/rel_name.c \
	$(srcdir)/seal.c \
	$(srcdir)/ser_sctx.c \
	$(srcdir)/sign.c \
	$(srcdir)/unseal.c \
	$(srcdir)/util_cksum.c \
	$(srcdir)/util_crypt.c \
	$(srcdir)/util_seed.c \
	$(srcdir)/util_seqnum.c \
	$(srcdir)/verify.c \
	$(srcdir)/wrap_size_limit.c \
	gssapi_err_krb5.c

#	$(srcdir)/pname_to_uid.c \
#	$(srcdir)/k5mech.c

OBJS = \
	accept_sec_context.$(OBJEXT) \
	acquire_cred.$(OBJEXT) \
	canon_name.$(OBJEXT) \
	compare_name.$(OBJEXT) \
	context_time.$(OBJEXT) \
	delete_sec_context.$(OBJEXT) \
	disp_name.$(OBJEXT) \
	disp_status.$(OBJEXT) \
	duplicate_name.$(OBJEXT) \
	export_name.$(OBJEXT) \
	export_sec_context.$(OBJEXT) \
	get_tkt_flags.$(OBJEXT) \
	gssapi_krb5.$(OBJEXT) \
	import_name.$(OBJEXT) \
	import_sec_context.$(OBJEXT) \
	indicate_mechs.$(OBJEXT) \
	init_sec_context.$(OBJEXT) \
	inq_context.$(OBJEXT) \
	inq_cred.$(OBJEXT) \
	inq_names.$(OBJEXT) \
	k5seal.$(OBJEXT) \
	k5unseal.$(OBJEXT) \
	krb5_gss_glue.$(OBJEXT) \
	process_context_token.$(OBJEXT) \
	rel_cred.$(OBJEXT) \
	rel_oid.$(OBJEXT) \
	rel_name.$(OBJEXT) \
	seal.$(OBJEXT) \
	ser_sctx.$(OBJEXT) \
	sign.$(OBJEXT) \
	unseal.$(OBJEXT) \
	util_cksum.$(OBJEXT) \
	util_crypt.$(OBJEXT) \
	util_seed.$(OBJEXT) \
	util_seqnum.$(OBJEXT) \
	verify.$(OBJEXT) \
	wrap_size_limit.$(OBJEXT) \
	gssapi_err_krb5.$(OBJEXT)

#	k5mech.$(OBJEXT) \
#	pname_to_uid.$(OBJEXT)

STLIBOBJS = \
	accept_sec_context.o \
	acquire_cred.o \
	canon_name.o \
	compare_name.o \
	context_time.o \
	delete_sec_context.o \
	disp_name.o \
	disp_status.o \
	duplicate_name.o \
	export_name.o \
	export_sec_context.o \
	get_tkt_flags.o \
	gssapi_krb5.o \
	import_name.o \
	import_sec_context.o \
	indicate_mechs.o \
	init_sec_context.o \
	inq_context.o \
	inq_cred.o \
	inq_names.o \
	k5seal.o \
	k5unseal.o \
	krb5_gss_glue.o \
	process_context_token.o \
	rel_cred.o \
	rel_oid.o \
	rel_name.o \
	seal.o \
	ser_sctx.o \
	sign.o \
	unseal.o \
	util_cksum.o \
	util_crypt.o \
	util_seed.o \
	util_seqnum.o \
	verify.o \
	wrap_size_limit.o \
	gssapi_err_krb5.o

#	k5mech.o \
#	pname_to_uid.o

HDRS= $(ETHDRS)

EHDRDIR=$(BUILDTOP)$(S)include$(S)gssapi
EXPORTED_HEADERS= gssapi_krb5.h

##DOS##LIBOBJS = $(OBJS)

all-windows:: win-include $(SRCS) $(HDRS)

all-unix:: $(SRCS) $(HDRS) includes
all-unix:: all-libobjs

win-include::
	if not exist $(EHDRDIR)\nul mkdir $(EHDRDIR)
	copy gssapi_krb5.h $(EHDRDIR)

clean-unix:: clean-libobjs
	$(RM) $(ETHDRS) $(ETSRCS)

clean-windows::
	$(RM) $(EHDRDIR)\gssapi_krb5.h
	if exist $(EHDRDIR)\nul rmdir $(EHDRDIR)

install::
	@set -x; for f in $(EXPORTED_HEADERS) ; \
	do $(INSTALL_DATA) $(srcdir)/$$f	\
		$(DESTDIR)$(KRB5_INCDIR)/gssapi/$$f ; \
	done

depend:: $(ETSRCS)

includes:: 

install::
