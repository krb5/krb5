AC_INIT(configure.in)
CONFIG_RULES
AC_PROG_ARCHIVE
AC_PROG_ARCHIVE_ADD
AC_PROG_RANLIB
AC_PROG_INSTALL
AC_PROG_LEX
AC_PROG_AWK
AC_CHECK_HEADERS(syslog.h)
AC_REPLACE_FUNCS(setenv)
save_LIBS="$LIBS"
LIBS=-lgen
AC_CHECK_FUNCS(compile step)
[if test "$krb5_cv_func_compile" = true ; then
	LIBS="$save_LIBS -lgen"
else
	LIBS="$save_LIBS"
fi]
AC_CHECK_FUNCS(re_comp re_exec regcomp regexec openlog syslog closelog strftime vsprintf)
V5_SHARED_LIB_OBJS
V5_MAKE_SHARED_LIB(libkadm5srv,1.0,.., ./kadm5,srv)
V5_MAKE_SHARED_LIB(libkadm5clnt,1.0,.., ./kadm5,clnt)
GSSRPC_SH_VERS=$krb5_cv_shlib_version_libgssrpc
AC_SUBST(GSSRPC_SH_VERS)
GSSAPI_KRB5_SH_VERS=$krb5_cv_shlib_version_libgssapi_krb5
AC_SUBST(GSSAPI_KRB5_SH_VERS)
KDB5_SH_VERS=$krb5_cv_shlib_version_libkdb5
AC_SUBST(KDB5_SH_VERS)
KRB5_SH_VERS=$krb5_cv_shlib_version_libkrb5
AC_SUBST(KRB5_SH_VERS)
CRYPTO_SH_VERS=$krb5_cv_shlib_version_libcrypto
AC_SUBST(CRYPTO_SH_VERS)
COMERR_SH_VERS=$krb5_cv_shlib_version_libcom_err
AC_SUBST(COMERR_SH_VERS)
DYN_SH_VERS=$krb5_cv_shlib_version_libdyn
AC_SUBST(DYN_SH_VERS)
CopySrcHeader(adb.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(admin.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(admin_internal.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(admin_xdr.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(client_internal.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(kadm_rpc.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(server_acl.h,[$](BUILDTOP)/include/kadm5)
CopySrcHeader(server_internal.h,[$](BUILDTOP)/include/kadm5)
CopyHeader(adb_err.h,[$](BUILDTOP)/include/kadm5)
CopyHeader(chpass_util_strings.h,[$](BUILDTOP)/include/kadm5)
CopyHeader(kadm_err.h,[$](BUILDTOP)/include/kadm5)
AppendRule([all:: all-$(WHAT)])
V5_AC_OUTPUT_MAKEFILE
